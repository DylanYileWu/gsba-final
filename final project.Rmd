---
title: 'Olympic Porjct - GSBA Final Project '
output: html_document
---

#Introduction 

This report will analyze the Olympic data from 2000 to 2012, and only the participants – who earned metal(s) – are included in this dataset. The aggregation data only includes 2012 Olympic Games (aggreatedinfo.csv), because indexes of Human Development Index (HDI), Population, and Gross Domestic Product (GDP) are approximately from year 2012 or 2013.

All the data are available here:https://github.com/DylanYileWu/gsba-final.git

Clarification: Given the limited time and dataset, I aggregated the year 2012 data by the countries of the athletes (combinedata.csv). If more time are given, data like yearly HDI indexes for each country, yearly populations for each country, yearly GDP for each country can be used to better study the relation among HDI indexes, GDP, population,and athletes who won the trophies, aggregation will base on the countries of the athletes and the year of the Olympic Games.

#Data columns  definition(combinedata.csv):

competing_country: Country name 

competing_country_code: Country code 

sports_involve: How many sports this country participant

mean_age: The average age for all the participants  from this country 

totalgold: Total earned gold metals for this country

totalsilver: Total earned silver medals for this country

totalbronze: Total earned bronze medals for this country

totalmedal: Total medals for this country(including gold, solver, and bronze)

top_perf_sport: The best performance sport for this country

top_perf_sport_medal: The corresponding number of medals for the top performance sport 

hdi: Human development index 

life_expectancy_at_birth:Life expectancy

mean_years_of_schooling: Average years in school

expected_years_of_schoolings: Expeced years in school

gross_national_income_per_captia: GNI per captia

hdiranking: Ranking by HDI, the lower the better

population: Total population

GDP: GDP for this country

# Data Analysis - Original Data

## Medals earned by each country
```{r echo=FALSE}
#loading data
origindata=read.csv("Olympics Data.csv")
combinedata=read.csv("combinedata.csv")
```

```{r  comment=NULL, message=FALSE, warning=FALSE}
library(rworldmap)
total_madel=0
total_madel=tapply(origindata$Tota_Medals,origindata$Competing.Country, FUN=sum)
#make the data as table
total_madel=as.table(total_madel)
total_madel=data.frame(total_madel)
#assign column names
colnames(total_madel)=c("Country","Total_medal")
#create a map-shaped window
mapDevice('x11')
#create the map
capture.output(spdf <- joinCountryData2Map(total_madel, joinCode="NAME",
              nameJoinColumn="Country"), file='NUL')
mapCountryData(spdf, nameColumnToPlot="Total_medal", catMethod="fixedWidth",
               mapTitle="Total medal(s) for each participant country")
```


## Athlete Age
```{r echo=T}
#Summary of age
summary(origindata$Age)
#The boxplot chart
boxplot(origindata$Age,col=c("red"),ylab="Age Range")
#Age freq bar chart 
agecount.freq=table(origindata$Age)
barplot(agecount.freq,xlab="Age Range")

```

### Summary-Athlete Age
The winning athletes' ages ranging from 15 to 61, with the mean age 26. Nearly half of the athletes age from 23 to 29, which represent the middle fifty percent of all the participants. Overall, the participants age is normally distributed, and there are few old athletes as well - right skewed. 

## Sports 
```{r echo=T}
sport.freq=data.frame(origindata$Sport)
#sort the sport frequency in decreasing order
sport.freq=sort(table(origindata$Sport),decreasing=T)
#show the top 5 popular sports
barplot(sport.freq[1：5],xlab="Sport",ylab="Number of athlete who won the trophies")
```

### Summary-Sports

The top five most-attended sports are Athletics, Rowing, Swimming, Football, and Hockey.
```{r echo=T}
sport.freq[1：5]
```

## Does Age affect athlete to obtain medals
```{r echo=T}
#number of medals by age
num_medals=tapply(origindata$Tota_Medals, origindata$Age, FUN=sum)
#number of gold medals by age
num_gold_medals=tapply(origindata$Gold_Medals, origindata$Age, FUN=sum)
#number of athelete by age is calculated earlier (agecount.freq)
medal_per_person_by_age=num_medals/agecount.freq
gold_per_person_by_age=num_gold_medals/agecount.freq
#Access the values 
barplot(medal_per_person_by_age,xlab="Age",ylab="Average medal (gold, silver, bronze) 
  by age group",main="Medal (gold, silver, bronze) per capita in different age group")
medal_per_person_by_age
barplot(gold_per_person_by_age,xlab="Age",ylab="Average gold medal by age group",
        main="Gold Medal per capita in different age group")
gold_per_person_by_age
```

### Summary - Does Age affect athlete to obtain medals

Age does affect the overall performance in each age group. From the "Medal (gold, silver, bronze) per capita in different age group" chart, Young athletes (from age 15 to 17) achieve higher medals per capita than the rest age groups. However, Age has less effects on athlete obtaining gold medals, young athlete still shows higher achievement. Moreover, Athlete from age 49 to 54 shows high rate of getting gold medals. Such phenomenon can be caused by the small amount of old participants, and it may also mean that those old athletes has long time practice in the sports field they compete.

# Data Analysis - Combine Data

## Correlation among data

### visualized correlation table
```{r warning=FALSE,message=FALSE}
attach(combinedata)
d <- data.frame(sports_involve=sports_involve,avg_age=mean_age,totalmedal=totalmedal,
                HDI=hdi,life_expectancy=life_expectancy_at_birth,
                avg_yrs_in_school=mean_years_of_schooling
                ,exp_yrs_in_school=expected_years_of_schoolings,
                GNI=gross_national_income_per_captia，
                HDI_ranking=hdiranking,Population=population,GDP=GDP)
# delete all the missing value
d=na.omit(d)
#create the correlation table
dtable=cor(d)
# visualize the correlation table
library('corrplot') #package corrplot
corrplot(dtable, method = "circle")
```

###scatter plot
```{r warning=FALSE}
#the scatter plot
pairs(d, data=mtcars,main="The scatter plot")
```

### Summary-Correlation among data
From the correlation table, It is clear that all the indexes from the Human Development Index (HDI.csv) table have strong positive relationship with each other, and the high negative relationship between HDI ranking and rest indexes, which is expected since higher HDI will be ranked as smaller number.  Moreover, those HDI indexes show strong relationship with GDP, which is also expected since high GDP will contribute to human living quality. The population overall has negative correlation with most indexes from HDI table and GDP, which means high population becomes a burden to a high population country. Overall, most the indexes have either weak or median positive relation with number of sports (sports_involve) that a country participates, which further influence the medals (totalmedal) that a country can get in the end.


## Top performance sport for each country
```{r warning=FALSE,strip.white=T}
#the scatter plot
dt=data.frame(combinedata)
cols <- c(1, 8:10)
dt[, cols]
```

### Summary-Top performance sport
For many countries, the medals from top performance sport usually consisit most of the total medals earned for 2012 Oliypic Game 


